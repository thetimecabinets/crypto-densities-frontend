<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>üêã Whale Wall Tracker ‚Äì CryptoDensities.pro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Track real-time crypto whale buy and sell walls on Binance and Bybit. Visualize price levels with high liquidity resistance.">
  <style>
    body { font-family: Arial, sans-serif; background-color: #f9f9f9; margin: 0; padding: 0; }
    nav {
      background-color: #2c3e50;
      padding: 15px;
      color: white;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    nav a {
      color: white;
      text-decoration: none;
      font-weight: bold;
    }
    .container { max-width: 1400px; margin: 40px auto; padding: 0 20px; display: flex; flex-wrap: wrap; gap: 20px; }
    .left-column { flex: 2; min-width: 300px; }
    .right-column {
      flex: 1;
      min-width: 280px;
      background-color: #fff;
      border: 1px solid #ddd;
      padding: 20px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      height: fit-content;
    }
    h1, h2 { color: #2c3e50; }
    .filters {
      margin-bottom: 15px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .filter-group {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    select, button {
      padding: 6px 10px;
      font-size: 14px;
    }
    .table-container { overflow-x: auto; }
    table {
      width: 100%;
      border-collapse: collapse;
      background-color: white;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      min-width: 800px;
    }
    th, td {
      padding: 12px;
      border-bottom: 1px solid #ddd;
      text-align: left;
    }
    .buy { color: green; font-weight: bold; }
    .sell { color: red; font-weight: bold; }
    @media (max-width: 768px) {
      nav { flex-direction: column; align-items: center; }
      .container { flex-direction: column; }
    }
  </style>
</head>
<body>

  <nav>
    <a href="/">üêã Whale Walls</a>
    <a href="/market-sentiment/">üìä Market Sentiment</a>
    <a href="/position-calculator/">üßÆ Position Calculator</a>
    <a href="/how-to-use-whale-wall/">üìò How It Works</a>
  </nav>

  <div class="container">
    <div class="left-column">
      <h1>üêã Whale Wall Tracker</h1>
      <p>Live tracking of large limit order walls on Binance and Bybit.</p>

      <div class="filters">
        <div class="filter-group">
          <label for="exchangeFilter">Exchange:</label>
          <select id="exchangeFilter">
            <option value="">All</option>
            <option value="Binance">Binance</option>
            <option value="Bybit">Bybit</option>
          </select>
        </div>
        <div class="filter-group">
          <label for="coinFilter">Coin:</label>
          <select id="coinFilter"></select>
        </div>
        <div class="filter-group">
          <label for="typeFilter">Type:</label>
          <select id="typeFilter">
            <option value="">All</option>
            <option value="buy">Buy</option>
            <option value="sell">Sell</option>
          </select>
        </div>
        <div class="filter-group">
          <label for="valueFilter">Value:</label>
          <select id="valueFilter">
            <option value="">All</option>
            <option value="100000">> $100K</option>
            <option value="250000">> $250K</option>
            <option value="500000">> $500K</option>
            <option value="1000000">> $1M</option>
          </select>
        </div>
        <div class="filter-group">
          <label for="ageFilter">Age:</label>
          <select id="ageFilter">
            <option value="">All</option>
            <option value="3600">&lt; 1h</option>
            <option value="21600">&lt; 6h</option>
            <option value="86400">&lt; 24h</option>
            <option value=">86400">&gt; 24h</option>
          </select>
        </div>
        <button onclick="resetFilters()">Reset</button>
      </div>

      <div class="table-container">
        <table id="wallsTable">
          <thead>
            <tr>
              <th>Type</th><th>Exchange</th><th>Coin</th><th>Price ($)</th>
              <th>Quantity</th><th>Value ($)</th><th>Distance (%)</th>
              <th>Age</th><th>Volatility</th><th>Volume</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <div class="right-column">
      <h2>Featured Content</h2>
      <p>Discover curated tools, insights, and exclusive crypto resources.</p>
      <img src="https://via.placeholder.com/300x250?text=Your+Ad+Here" alt="Ad Placeholder" style="width: 100%; max-width: 300px;">
    </div>
  </div>

  <script>
    let rawData = [];

    function formatNumberShort(n) {
      if (!n || isNaN(n)) return "N/A";
      if (n >= 1e9) return (n / 1e9).toFixed(1) + 'B';
      if (n >= 1e6) return (n / 1e6).toFixed(1) + 'M';
      if (n >= 1e3) return (n / 1e3).toFixed(1) + 'K';
      return n.toString();
    }

    async function fetchData() {
      try {
        const res = await fetch("https://api.cryptodensities.pro/api/walls");
        rawData = await res.json();
        populateCoinFilter();
        renderTable();
      } catch (err) {
        console.error("Failed to fetch walls:", err);
      }
    }

    function populateCoinFilter() {
      const coinSelect = document.getElementById("coinFilter");
      const coins = [...new Set(rawData.map(w => w.coin))].sort();
      coinSelect.innerHTML = '<option value="">All</option>' + coins.map(c => `<option value="${c}">${c}</option>`).join("");
    }

    function renderTable() {
      const tbody = document.querySelector("#wallsTable tbody");
      tbody.innerHTML = "";

      const exchange = document.getElementById("exchangeFilter").value;
      const coin = document.getElementById("coinFilter").value;
      const type = document.getElementById("typeFilter").value;
      const value = parseFloat(document.getElementById("valueFilter").value) || 0;
      const ageFilter = document.getElementById("ageFilter").value;

      rawData.forEach(w => {
        if (
          (exchange && w.exchange !== exchange) ||
          (coin && w.coin !== coin) ||
          (type && w.type !== type) ||
          (w.value < value)
        ) return;

        if (ageFilter === ">86400" && w.age_seconds <= 86400) return;
        if (ageFilter && ageFilter !== ">86400" && w.age_seconds > parseFloat(ageFilter)) return;

        const row = document.createElement("tr");
        row.innerHTML = `
          <td class="${w.type}">${w.type.charAt(0).toUpperCase() + w.type.slice(1)}</td>
          <td>${w.exchange}</td>
          <td>${w.coin}</td>
          <td>${w.price.toLocaleString()}</td>
          <td>${w.quantity}</td>
          <td>$${formatNumberShort(w.value)}</td>
          <td>${w.distance}</td>
          <td>${w.age}</td>
          <td>${w.volatility !== undefined && w.volatility !== null ? w.volatility.toFixed(2) + '%' : 'N/A'}</td>
          <td>$${formatNumberShort(w.volume)}</td>
        `;
        tbody.appendChild(row);
      });
    }

    function resetFilters() {
      document.querySelectorAll(".filters select").forEach(select => select.value = "");
      renderTable();
    }

    document.querySelectorAll(".filters select").forEach(select => {
      select.addEventListener("change", renderTable);
    });

    fetchData();
  </script>
</body>
</html>
